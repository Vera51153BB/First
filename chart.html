<!doctype html>
<html lang="en" data-theme="blue">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Cryptocurrency chart on the OKX exchange</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="/assets/fonts/momo-trust-display-400.woff2">
  <link rel="icon" href="/images/bts153.ico" sizes="16x16" type="image/x-icon" />
  <link rel="icon" href="/images/bts153-32.ico" sizes="32x32" type="image/x-icon" />

    <style>
    @font-face{
      font-family:"Momo Trust Display";
      src:url("/assets/fonts/momo-trust-display-400.woff2") format("woff2");
      font-weight:400;
      font-style:normal;
      font-display:swap;
    }

    /* === BRAND PLACEHOLDER: –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç + –±–∞–∑–æ–≤–∞—è —Ç–æ–Ω–∫–∞—è —Ç–µ–Ω—å –∏ –∞–Ω–∏–º–∞—Ü–∏—è —Ç–µ–Ω–∏ === */
    /* –ë–∞–∑–∞: –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç –∏ –±–∞–∑–æ–≤–∞—è —Ç–µ–Ω—å –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –Ω–∞ —Å–≤–µ—Ç–ª–æ–º —Ñ–æ–Ω–µ */
    /* --- —Å–ª–æ–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ –ø–æ–≤–µ—Ä—Ö –≥—Ä–∞—Ñ–∏–∫–∞ --- */
    #chartRoot{ position:relative; }
    .brand-holder{
      position:absolute; inset:0;
      display:none;                      /* –≤–∫–ª—é—á–∞–µ—Ç—Å—è JS */
      justify-content:center; align-items:center;
      z-index:10; pointer-events:none;
    }
    .brand-wrap{ transform:translateY(-4%); }
    .brand-logo{ width:min(92vw,960px); height:auto; display:block; }
    
    /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç + –±–∞–∑–æ–≤–∞—è —Ç–æ–Ω–∫–∞—è —Ç–µ–Ω—å (–µ–¥–∏–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Ç–µ–º) */
    .brand-logo text{
      fill:#fff;
      text-shadow:0 0 5px rgba(0,0,0,.3);
    }
    
    /* –ú–∏–≥–∞—é—â–∞—è —Ü–≤–µ—Ç–Ω–∞—è —Ç–µ–Ω—å (–∫—Ä–∞—Å–Ω—ã–π ‚Üî –∑–µ–ª—ë–Ω—ã–π), —Ü–∏–∫–ª ~2s */
    .brand-anim{
      animation:brandShadowPulse 2s ease-in-out infinite;
      will-change:text-shadow;
    }
    @keyframes brandShadowPulse{
      0%{
        text-shadow:
          0 0 5px rgba(0,0,0,.30),
          0 0 6px rgba(255,59,48,.65);   /* red */
      }
      50%{
        text-shadow:
          0 0 5px rgba(0,0,0,.30),
          0 0 6px rgba(0,0,0,.10);       /* –ø–æ—á—Ç–∏ –ø—Ä–æ–ø–∞–ª–∞ —Ü–≤–µ—Ç–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ */
      }
      100%{
        text-shadow:
          0 0 5px rgba(0,0,0,.30),
          0 0 6px rgba(52,199,89,.70);   /* green */
      }
    }
    
    /* –≠–∫–æ–Ω–æ–º–∏—è/–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å */
    @media (prefers-reduced-motion:reduce){
      .brand-anim{
        animation:none!important;
        text-shadow:
          0 0 5px rgba(0,0,0,.30),
          0 0 6px #d6aa7e;              /* —Ç—ë–ø–ª–∞—è ¬´–∑–∞–º–æ—Ä–æ–∑–∫–∞¬ª */
      }
    }
    
    /* –≠–∫–æ–Ω–æ–º–∏—è: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç —É–º–µ–Ω—å—à–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—á–Ω—ã–π –≤–∏–¥ */
    @media (prefers-reduced-motion: reduce) {
      .brand-anim {
        animation: none !important;
        text-shadow:
          0 0 5px rgba(0,0,0,.30),
          0 0 6px #d6aa7e; /* –∑–∞–º–æ—Ä–æ–∑–∫–∞ –æ–±–≤–æ–¥–∫–æ–π —Ç—ë–ø–ª–æ–≥–æ —Ç–æ–Ω–∞ */
      }
    }
    
    :root{
      --sep:#a7a093;
      --green:#79c172;
      --red:#ff5f5f;

      --hbar:46px;        /* –±–∞–∑–æ–≤–∞—è –≤—ã—Å–æ—Ç–∞ –∑–æ–Ω */
      --hbar-min:32px;    /* —É–∂–∞—Ç–∏–µ –Ω–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –Ω–∏–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
      --padX:clamp(12px, 4vw, 18px);   /* –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø */

      --radius:12px;
      --muted:#9bb0cc;
      --shadow:0 10px 28px rgba(0,0,0,.35);
      --fontSize: clamp(12px, 1.8vw, 14px);
      --uiSize: clamp(28px, 5.5vw, 34px);
      --icon:  clamp(14px, 2.8vw, 18px);

            /* ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ... */
      --focus-ring: rgba(122,167,255,.75);   /* —Ü–≤–µ—Ç –∫–æ–ª—å—Ü–∞ */
      --focus-glow: rgba(122,167,255,.35);   /* –≤–Ω–µ—à–Ω–µ–µ –º—è–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */

      /* –ò–ù–î–ò–ö–ê–¢–û–†–´ */
      --led-ok:#5fe281;      /* –∑–µ–ª—ë–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ */
      --led-warn:#ffc857;    /* –∂—ë–ª—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ */
      --led-bad:#ff5f5f;     /* –∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ */

      /* ‚Äî‚Äî‚Äî –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ –ª–µ–≥–µ–Ω–¥–µ: ¬´—Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ¬ª —Ç–æ—á–∫–∏ —Å –ª—ë–≥–∫–∏–º –¥—ã—Ö–∞–Ω–∏–µ–º ‚Äî‚Äî‚Äî */
      /* –ø–∞–ª–∏—Ç—Ä–∞ —Å—Ñ–µ—Ä */
      --ok-mid:#3BD16A;   --ok-deep:#1E7E46;   --ok-glow:rgba(59,209,106,.42);
      --warn-mid:#FFCC66; --warn-deep:#CC8A00; --warn-glow:rgba(255,204,102,.40);
      --bad-mid:#FF5F5F;  --bad-deep:#B80D1A;  --bad-glow:rgba(255,95,95,.42);
    
      /* –¥—ã—Ö–∞–Ω–∏–µ: –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞–º–ø–ª–∏—Ç—É–¥–∞ (–º–æ–∂–Ω–æ –ø–æ–¥–∫—Ä—É—Ç–∏—Ç—å) */
      --breathe-dur: 1400ms;
      --breathe-min: .92;
      --breathe-max: 1.12;
    }
    
    @media (max-width: 768px){
      :root{
        --uiSize: clamp(32px, 7vw, 36px);
        --icon:  clamp(22px, 4vw, 26px);
      }
    }
    
    /* —Ç–µ–º—ã */
    html[data-theme="blue"]{
      --bg:#050029;
      --panel:#0a0637;
      --panel2:#070430;
      --text:#eaf0ff; /* –±—É–¥–µ—Ç –ø–æ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º */
    }
    html[data-theme="dark"]{
      --bg:#0b0e14;
      --panel:#11151c;
      --panel2:#0f1319;
      --text:#e5e7eb;
    }
    html[data-theme="light"]{
      --bg:#f7f8fc;
      --panel:#ffffff;
      --panel2:#f2f4f8;
      --text:#0d1321;
    }

    *{box-sizing:border-box}
    html,body{
      height:100%; margin:0;
      background:var(--bg); color:var(--text);
      font: var(--fontSize)/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      overflow:hidden; /* –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
    }

    .viewport{
      /* —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –≤–µ—Å—å –≤—å—é–ø–æ—Ä—Ç –±–µ–∑ —É—á–∞—Å—Ç–∏—è svh,
         —á—Ç–æ–±—ã –Ω–µ –¥–µ—Ä–≥–∞–ª–æ—Å—å –æ—Ç –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏/–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã */
      position: fixed;
      inset: 0;
      display: grid;
      grid-template-rows: var(--h) 1px 1fr 1px var(--h); /* –≤–µ—Ä—Ö, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, —Ü–µ–Ω—Ç—Ä, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –Ω–∏–∑ */
      background: var(--bg);
    }
    
    @media (max-height:768px){ .viewport{ --h:var(--hbar-min); } }
    @media (min-height:769px){ .viewport{ --h:var(--hbar); } }

    /* —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π ¬´–±–æ—Ä–¥–µ—Ä¬ª –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–æ–º –∏ –±–∞—Ä–æ–º */
    .divider{
      height:1px;
      background:var(--sep);
      position:relative;
      z-index:2;              /* –ø–æ–≤–µ—Ä—Ö —Å–æ—Å–µ–¥–µ–π */
    }

    /* –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å-–ø–æ–¥–ª–æ–∂–∫–∞ (–±–µ–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –¢–ó) */
    /* –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å */
    .topbar{
      height: var(--h);                           /* ‚Üê —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É —Å—Ç—Ä–æ–∫–∏ */
      display: flex; align-items: center;         /* ‚Üê –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
      padding-left: var(--padX);
      padding-right: 12px;                        /* —Å–∏–º–º–µ—Ç—Ä–∏—è —Å –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª—å—é */
      background: linear-gradient(180deg,var(--panel),var(--panel2));
      border-bottom: 1px solid rgba(255,255,255,.08);
    }

    .center{
      position: relative;
      background: var(--bg);
      display: flex;
      align-items: stretch;     /* –ø–æ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–π –æ—Å–∏ ‚Äî –≤–æ –≤—Å—é –≤—ã—Å–æ—Ç—É —Å—Ç—Ä–æ–∫–∏ */
      justify-content: flex-start;  /* –ø—Ä–∏–∂–∞—Ç—å —Å–ª–µ–≤–∞ */
      overflow: hidden;
      padding: 0;
    }

    /* –Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–µ–∑–µ—Ä–≤ 12px —Å–ø—Ä–∞–≤–∞ */
    .bottombar{
      height: var(--h);
      display:flex; align-items:center;
      padding-left: var(--padX);
      padding-right: 12px;       /* —Ä–µ–∑–µ—Ä–≤ –∑–∞ –∫–Ω–æ–ø–∫–æ–π */
      background:linear-gradient(180deg,var(--panel),var(--panel2));
      border-top:1px solid rgba(0,0,0,.18);
      gap:8px;
    }
    
    /* –ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ ‚Äî —Ç—è–Ω–µ—Ç—Å—è, –Ω–æ –±–µ–∑ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏—è –ø–∞—Ä—ã */
    .left{
      display:flex; align-items:center; gap:8px;
      min-width:0; white-space:nowrap;
      flex:1 1 auto;            /* –≥—Ä—É–ø–ø–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—É—é —à–∏—Ä–∏–Ω—É */
      overflow: visible;        /* –±—ã–ª–æ hidden ‚Äî –Ω—É–∂–Ω–æ visible, —á—Ç–æ–±—ã –Ω–µ —Ä–µ–∑–∞—Ç—å —Å–≤–µ—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ */
    }
    
    /* –ü–ê–†–ê ‚Äî –±–æ–ª—å—à–µ –ù–ï —Ä–∞—Å—Ç—ë—Ç, —Ç–æ–ª—å–∫–æ —Å–∂–∏–º–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –º–µ—Å—Ç–∞ */
    .pair{
      display:block;
      flex:0 1 auto;            /* <-- –±—ã–ª–æ 1 1 auto; —Ç–µ–ø–µ—Ä—å 0 1 auto */
      min-width:0;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      font-weight:400;
      font-weight:inherit;
    }
    
    /* –≤—Ä–µ–º—è ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ, –Ω–µ —Å–∂–∏–º–∞—Ç—å */
    .time{
      color:var(--muted);
      font-variant-numeric: tabular-nums;
      margin-left:8px;
      flex:0 0 auto;
    }

    /* LQDZ: –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ (SRFL|TPCL|STLC) ‚Äî —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –≤ —Ü–≤–µ—Ç .time */
    .pill-group .btn.is-active{
      /* –ù–ï —Ç—Ä–æ–≥–∞–µ–º font-weight –∏ font-size */
      color: var(--muted) !important;     /* —Ç–æ—Ç –∂–µ —Ü–≤–µ—Ç, —á—Ç–æ —É .time */
    }
    
    /* –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ hover/active, –Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ü–≤–µ—Ç */
    .pill-group .btn.is-active:hover,
    .pill-group .btn.is-active:active,
    .pill-group .btn.is-active:focus{
      color: var(--muted) !important;
      /* —Ñ–æ–Ω –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ —É –æ–±—ã—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å –≤–∏–∑—É–∞–ª */
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      /* –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–Ω–µ–π, —á—Ç–æ–±—ã –Ω–µ ¬´—É—Ç–æ–ª—â–∞–ª–æ—Å—å¬ª */
      box-shadow: none;
    }
    
    /* –û–±–Ω–æ–≤–∏—Ç—å ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–∞, –Ω–µ —Å–∂–∏–º–∞—Ç—å, –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–∑–æ—Ä —Å–ª–µ–≤–∞ */
    #btnRefresh{
      margin-left:8px;
      flex:0 0 var(--uiSize);
    }

    /* –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ —Å–≤–µ—á–µ–Ω–∏–µ–º –∏ –±–µ–ª—ã–º –±–ª–∏–∫–æ–º */
    /* —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π ¬´—à–∞—Ä¬ª ‚Äî 1 —ç–ª–µ–º–µ–Ω—Ç */
    .led{
      --led-size: clamp(12px, 2.8vw, 14px);
      --led-color: var(--led-ok);         /* –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –û–ö */
      position: relative;
      width: var(--led-size);
      height: var(--led-size);
      border-radius: 50%;
      flex: 0 0 auto;
      /* —Ç–µ–ª–æ —à–∞—Ä–∞ + –º—è–≥–∫–∞—è –ø–µ—Ä–∏—Ñ–µ—Ä–∏—è —á–µ—Ä–µ–∑ —Ä–∞–¥–∏–∞–ª—å–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã */
      background:
        radial-gradient(45% 45% at 30% 28%, rgba(255,255,255,.95), rgba(255,255,255,0) 60%) /* –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –±–ª–∏–∫–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */,
        radial-gradient(100% 100% at 50% 50%, var(--led-color), color-mix(in srgb, var(--led-color) 65%, #000) );
      /* –≤–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ ‚Äî –ª—ë–≥–∫–æ–µ ¬´–¥—ã—Ö–∞–Ω–∏–µ¬ª */
      box-shadow:
        0 0 10px color-mix(in srgb, var(--led-color) 75%, transparent),
        0 0 22px color-mix(in srgb, var(--led-color) 45%, transparent);
      animation: none; /* –∞–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞, —Å–≤–µ—á–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è. animation: led-breathe 2.8s ease-in-out infinite; */
      cursor: pointer;
    }
    
    /* –±–µ–ª—ã–π ¬´–±–ª–∏–∫¬ª ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π –∏ –±–µ–∑ –æ–±–≤–æ–¥–∫–∏ */
    .led::after{
      content:"";
      position:absolute;
      left:18%; top:16%;
      width:28%; height:28%;
      border-radius:50%;
      background:#fff;
      box-shadow:0 0 3px rgba(255,255,255,.6);
    }
    
    /* —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ –¥–∞—Ç–∞-–∞—Ç—Ä–∏–±—É—Ç */
    .led[data-state="ok"]   { --led-color: var(--led-ok); }
    .led[data-state="warn"] { --led-color: var(--led-warn); }
    .led[data-state="bad"]  { --led-color: var(--led-bad); }
    
    /*  –º—è–≥–∫–æ–µ ¬´–¥—ã—Ö–∞–Ω–∏–µ¬ª —Å–≤–µ—á–µ–Ω–∏—è 
    @keyframes led-breathe{
      0%,100%{ box-shadow:
        0 0 8px  color-mix(in srgb, var(--led-color) 65%, transparent),
        0 0 18px color-mix(in srgb, var(--led-color) 35%, transparent); }
      50%{ box-shadow:
        0 0 12px color-mix(in srgb, var(--led-color) 80%, transparent),
        0 0 26px color-mix(in srgb, var(--led-color) 50%, transparent); }
    } */
    
    /* –ø—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: TF + icon buttons */
    .right{ display:flex; align-items:center; gap: clamp(8px, 2vw, 12px); }

    /* –ë–ê–ó–û–í–ê–Ø –ö–ù–û–ü–ö–ê */
    .btn{
      height: var(--uiSize);
      padding: 0 clamp(10px, 2.6vw, 12px);
      border: none;
      border-radius: var(--radius);                     /* ‚Üê –¥–æ–±–∞–≤–∏–ª–∏ */
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      color: var(--text);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
      font-weight: 800;
      outline: none;                                    /* ring —Ä–∏—Å—É–µ–º —Ç–µ–Ω—å—é */
      -webkit-tap-highlight-color: transparent;         /* –º–æ–±–∏–ª—å–Ω—ã–π —Ç–∞–ø */
      transition: box-shadow .15s ease, background .12s ease, transform .08s ease;
    }
    .btn:active{
      transform: translateY(1px);
      font-weight: 400;                /* –∫–∞–∫ .pair */
    }
    
    /* –ò–ö–û–ù–ö–ò-–ö–ù–û–ü–ö–ò (–∏–∫–æ–Ω–∫–∏ –±–µ–∑ —Ä–∞–º–∫–∏, –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –ø–ª–∞—à–∫–∞) */
    .btn-icon{
      width: var(--uiSize);
      padding: 0;
      aspect-ratio: 1 / 1;
      /* border:none;         ‚Üê —É–∂–µ –∑–∞–¥–∞–Ω–æ –≤ .btn, –º–æ–∂–Ω–æ –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å */
      /* box-shadow:none;     ‚Üê –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω */
    }
    
    /* —Ä–∞–∑–º–µ—Ä –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö SVG-–∏–∫–æ–Ω–æ–∫ –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞ —Ç–µ–º—ã */
    .btn-icon svg{
      width: var(--icon);
      height: var(--icon);
      display: block;
      fill: currentColor;                                /* –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π */
    }

    /* HOVER –¥–ª—è –∏–∫–æ–Ω–æ–∫ */
    .btn-icon:hover{
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,.04));
    }
    
    /* –û–ë–©–ï–ï –ö–û–õ–¨–¶–û –§–û–ö–£–°–ê (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å) */
    .btn:focus-visible{
      box-shadow:
        0 0 0 2px rgba(0,0,0,.35),        /* –ø–æ–¥–ª–æ–∂–∫–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
        0 0 0 4px var(--focus-ring),      /* –∫–æ–ª—å—Ü–æ */
        0 0 12px 2px var(--focus-glow);   /* –º—è–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
    }
    
    /* –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π hover –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫-–ø–∏–ª–ª–æ–≤ (–≤ —Ç.—á. TF) */
    .btn:hover{
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,.04));
    }
    
    /* Disabled-—Å–æ—Å—Ç–æ—è–Ω–∏–µ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å) */
    .btn:disabled{
      opacity: .5;
      cursor: default;
      pointer-events: none;
    }

    /* –º–æ–¥–∞–ª–∫–∏ */
    .backdrop{
      position:fixed; inset:0; display:none; align-items:center; justify-content:center;
      background:rgba(0,0,0,.45); z-index:20; padding:12px;
    }
    .backdrop.show{ display:flex; }
    .modal{
      width:min(680px,96vw);
      background:linear-gradient(180deg,var(--panel),var(--panel2));
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px; padding:14px 14px 16px;
      box-shadow: var(--shadow);
    }
    .modal h3{ margin:2px 0 10px; font-size:clamp(14px,2.6vw,16px); }
    .grid-3{ display:grid; grid-template-columns: repeat(3,minmax(0,1fr)); gap:10px; }
    .grid-2{ display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:10px; }

    .pill{
      border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius:12px; padding:10px 12px; text-align:center; cursor:pointer; font-weight:800;
    }
    .pill.active{ border-color: #7aa7ff; box-shadow: inset 0 0 0 1px rgba(122,167,255,.35); }

    .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin:10px 0; }
    .label{ color:var(--muted); }

    .close{ margin-top:12px; width:100%; }

    /* –ª–µ–≥–µ–Ω–¥–∞ */
    .legend ul{
      /* —É–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã */
      list-style: none;
      margin: 8px 0 0;
      padding: 0;
    }
    .legend li{
      /* –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –∏ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä—è–¥ */
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }

    /* –±–∞–∑–æ–≤–∞—è —Ç–æ—á–∫–∞ */
    .legend .dot{
      position:relative;
      width:14px; height:14px; border-radius:50%;
      flex:0 0 auto;
    }
    
    /* —Å–∞–º–∞ ¬´—Å—Ñ–µ—Ä–∞¬ª (—Ä–∞–¥ –≥—Ä–∞–¥–∏–µ–Ω—Ç + –ª—ë–≥–∫–∏–π –±–ª–∏–∫) */
    .legend .dot::before{
      content:""; position:absolute; inset:0; border-radius:inherit;
      background:
        radial-gradient(circle at 34% 30%, rgba(255,255,255,.95) 0 18%, transparent 19%) /* –±–ª–∏–∫ */,
        radial-gradient(circle at 50% 55%, var(--_mid) 0 70%, var(--_deep) 76% 100%);    /* —Ç–µ–ª–æ */
      box-shadow: 0 0 8px var(--_glow);
    }
    
    /* –≤–Ω–µ—à–Ω–∏–π –æ—Ä–µ–æ–ª ‚Äî –¢–û–õ–¨–ö–û –æ–Ω –∞–Ω–∏–º–∏—Ä—É–µ—Ç—Å—è */
    .legend .dot::after{
      content:""; position:absolute; inset:-8px; border-radius:inherit;
      background: radial-gradient(circle, var(--_glow), transparent 60%);
      opacity:.55; pointer-events:none;
      transform: scale(var(--breathe-min));
      animation: breathe var(--breathe-dur) ease-in-out infinite;
      will-change: transform, opacity;
    }
    
    /* –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π */
    .legend .dot.ok   { --_mid:var(--ok-mid);   --_deep:var(--ok-deep);   --_glow:var(--ok-glow); }
    .legend .dot.warn { --_mid:var(--warn-mid); --_deep:var(--warn-deep); --_glow:var(--warn-glow); }
    .legend .dot.bad  { --_mid:var(--bad-mid);  --_deep:var(--bad-deep);  --_glow:var(--bad-glow); }

    /* PNG-–≥—Ä–∞—Ñ–∏–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ü–µ–Ω—Ç—Ä, –Ω–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞—è—Å—å –∑–∞ —Ä–∞–º–∫–∏ */
    /* –ö–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ */
    #chartRoot{
      position: relative;
      height: 100%;                 /* –∑–∞–Ω—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω—É—é –≤—ã—Å–æ—Ç—É –æ–±–ª–∞—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
      min-height: 240px;            /* —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ */
      width: 100%;
      overflow-x: auto;             /* –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ —à–∏—Ä–∏–Ω—ã */
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;
    }
    #chartRoot.dragging { cursor: grabbing; }
    #chartRoot { cursor: grab; }
    
    /* PNG-–≥—Ä–∞—Ñ–∏–∫: –í–Ω—É—Ç—Ä–∏ ‚Äî –∫–∞—Ä—Ç–∏–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ *–ø–æ –≤—ã—Å–æ—Ç–µ* –∑–∞–Ω—è—Ç—å 100%, —à–∏—Ä–∏–Ω–∞ ‚Äî –∞–≤—Ç–æ (—á—Ç–æ–±—ã –¥–µ—Ä–∂–∞—Ç—å 3:2) */
    #candle-img{
      display: block;
      height: 100%;
      width: auto;
      max-width: none;              /* –Ω–µ —Å–∂–∏–º–∞—Ç—å –ø–æ —à–∏—Ä–∏–Ω–µ ‚Äî –ø—É—Å—Ç—å —É—Ö–æ–¥–∏—Ç –≤ —Å–∫—Ä–æ–ª–ª */
      object-fit: contain;
      user-select: none;
      -webkit-user-drag: none;
      pointer-events: auto;
      margin-left: 0;   /* –≤–∞–∂–Ω–æ: –ø—Ä–∏–∂–∞—Ç—å —Å–ª–µ–≤–∞ */
      margin-right: 0;
    }

    /* –∫–ª—é—á–µ–≤—ã–µ –∫–∞–¥—Ä—ã ¬´–¥—ã—Ö–∞–Ω–∏—è¬ª ‚Äî –º—è–≥–∫–∏–π –ø—É–ª—å—Å –æ—Ä–µ–æ–ª–∞ */
    @keyframes breathe{
      0%,100% { opacity:.35; transform: scale(var(--breathe-min)); }
      50%     { opacity:.85; transform: scale(var(--breathe-max)); }
    }
    
    /* —É–≤–∞–∂–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É ¬´—É–º–µ–Ω—å—à–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ¬ª */
    @media (prefers-reduced-motion: reduce){
      .legend .dot::after{ animation:none; opacity:.45; transform:none; }
    }

    /* < 336px: —Å–∫—Ä—ã–≤–∞–µ–º TF –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–µ—Ä–µ–¥ –Ω–∏–º */    
    @media (max-width: 336px){
      .pair .sep-tf,
      .pair .tf{ display:none; }
    }

    /* --- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä—É—Ç–∏–ª–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PNG (–Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫–∏) üîÑ ----------------------------------------- */
    /* –æ–ø–æ—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: –≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å ‚Äî —Ä–æ–¥–∏—Ç–µ–ª—å –¥–ª—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è */
    .topbar { position: relative; }
    
    /* —Å–ø–∏–Ω–Ω–µ—Ä –∫–∞–∫ –æ–≤–µ—Ä–ª–µ–π, ¬´—Å–≤–∏—Å–∞—é—â–∏–π¬ª –ø–æ–¥ –ø–∞–Ω–µ–ª—å—é */
    .topbar .chart-spinner{
      position: absolute !important;
      right: 120px !important;                 /* –≤–∞—à –±–∞–∑–æ–≤—ã–π –æ—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ */
      top: 100% !important;                   /* –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –Ω–∏–∂–Ω–µ–º—É –∫—Ä–∞—é topbar */
      transform: translateY(20px) !important; /* –≤—ã–ª–µ—Ç –≤ –æ–±–ª–∞—Å—Ç—å –≥—Ä–∞—Ñ–∏–∫–∞ (12‚Äì20px –ø–æ –¢–ó) */
      z-index: 30;                 /* –≤—ã—à–µ –≥—Ä–∞—Ñ–∏–∫–∞ */
      pointer-events: none;        /* —á—Ç–æ–±—ã –Ω–µ –∫–ª–∏–∫–∞–ª—Å—è */
    }
    
    /* —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏ ‚Äî –±–µ–∑ —Ñ–æ–Ω–∞ –∫–Ω–æ–ø–∫–∏ */
    .topbar .chart-spinner .spinner-btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: calc(var(--uiSize) * 1.5);   /* —É–≤–µ–ª–∏—á–µ–Ω–æ √ó1.2 –∫–∞–∫ –ø—Ä–æ—Å–∏–ª–∏ */
      height: calc(var(--uiSize) * 1.5);
      border: 0;
      background: transparent;
    }
    
    /* –≤—Ä–∞—â–µ–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–≤ 2 —Ä–∞–∑–∞): 280‚Äì320ms –Ω–∞ –æ–±–æ—Ä–æ—Ç */
    .topbar .chart-spinner .spinner-btn svg{
      width: calc(var(--icon) * 1.5);
      height: calc(var(--icon) * 1.5);
      animation: spin 0.8s linear infinite;
      fill: currentColor;
    }
    
    /* –∫–æ—Ä–æ—Ç–∫–∏–π ¬´—Ç–∏–∫¬ª —Ü–≤–µ—Ç–æ–º + —Å–∫—Ä–æ–º–Ω—ã–π glow –ø—Ä–∏ —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ */
    .topbar .chart-spinner.ok .spinner-btn svg{
      color: #21c16b;
      filter: drop-shadow(0 0 6px rgba(33,193,107,.35));
    }
    .topbar .chart-spinner.error .spinner-btn svg{
      color: #ff5f5f;
      filter: drop-shadow(0 0 6px rgba(255,95,95,.35));
    }
    
    /* —Å–∫—Ä—ã—Ç–∏–µ/–ø–æ–∫–∞–∑ */
    .topbar .chart-spinner{ opacity: 0; transition: opacity .12s ease; }
    .topbar .chart-spinner.show{ opacity: 1; }
    
    /* —É—á—ë—Ç –≤—ã—Ä–µ–∑–æ–≤ (iOS) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ */
    @supports (padding: max(0px)) {
      .topbar .chart-spinner{
        right: max(40px, env(safe-area-inset-right));
      }
    }
    
    @keyframes spin { to { transform: rotate(360deg); } }

    
   </style>
  
</head>
<body>
  <div class="viewport">
    <!-- –≤–µ—Ä—Ö–Ω—è—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞ 40px (–ø—É—Å—Ç–∞—è, –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–Ω–µ–ª–µ–π; –ø–æ –¢–ó –æ—Å—Ç–∞–≤–ª—è–µ–º) -->
    <div class="topbar">           
      <div class="left">
        <button class="btn" id="btnTF"><b>TF ¬∑ <span id="tfBtnVal">1h</span></b></button>
        <!-- –ö–Ω–æ–ø–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <button class="btn btn-icon" id="btnSettings" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <!-- SVG, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Ç–µ–º—ã: fill="currentColor", –ª–∏—à–Ω–∏–π –ø—É—Å—Ç–æ–π path —É–±—Ä–∞–Ω -->
            <path fill="currentColor"
              d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/>
          </svg>
        </button>
              <!-- LQDZ: –≤–∫–ª–∞–¥–∫–∏ —Ä–µ–∂–∏–º–æ–≤ –∑–æ–Ω (SRFL|TPCL|STLC); –±–∞–∑–æ–≤—ã–π SRFL -->
        <div id="lqdzTabs" class="pill-group">
          <span class="time">Zones:</span>
          <button type="button" class="btn is-active" data-mode="tpcl"><b>TPCL</b></button>
          <button type="button" class="btn" data-mode="srfl">SRFL</button>
          <button type="button" class="btn" data-mode="stlc">STLC</button>
        </div>
      </div>
      <!-- –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä—É—Ç–∏–ª–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ PNG (–Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫–∏) üîÑ -->
      <div id="chartSpinner" class="chart-spinner" aria-hidden="true">
        <div class="spinner-btn" tabindex="-1">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor"
              d="M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"/>
          </svg>
        </div>
      </div>     
      
    </div>

    <div class="divider"></div>

    <!-- —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å: —á–∏—Å—Ç–∞—è (–ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫)  -->
    <div class="center" id="chartRoot">
      <!-- BRAND PLACEHOLDER: –ø–æ–≤–µ—Ä—Ö —Ü–µ–Ω—Ç—Ä–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ PNG -->
      <div id="brandHolder" class="brand-holder">
        <div class="brand-wrap">
          <!-- –ë—ã–ª–æ 780√ó120 –∏ y=86; —Å—Ç–∞–ª–æ 1014√ó156 –∏ y=112 (√ó1.3) -->
          <!-- –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä-–±—Ä–µ–Ω–¥: 780√ó120, —à—Ä–∏—Ñ—Ç -10%, —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ -->
          <svg class="brand-logo" viewBox="0 0 780 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
            <!-- –¢—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ—è (–∞–Ω–∏–º–∞—Ü–∏—è —Ç–µ–Ω–∏ –ø–æ –¢–ó) -->
            <text x="50%" y="86" text-anchor="middle" class="brand-stroke-dark brand-anim"
                  style="font:400 77px/1.05 'Momo Trust Display',-apple-system,Segoe UI,Roboto,Inter,system-ui,sans-serif;">
              botcryptosignal
            </text>
            <text x="50%" y="86" text-anchor="middle" class="brand-stroke-light brand-anim"
                  style="font:400 77px/1.05 'Momo Trust Display',-apple-system,Segoe UI,Roboto,Inter,system-ui,sans-serif;">
              botcryptosignal
            </text>
            <text x="50%" y="86" text-anchor="middle" class="brand-text brand-anim"
                  style="font:400 77px/1.05 'Momo Trust Display',-apple-system,Segoe UI,Roboto,Inter,system-ui,sans-serif;">
              botcryptosignal
            </text>
          
            <!-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –Ω–µ–≤–∏–¥–∏–º—ã–π –¥—É–±–ª—å (—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞), –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ -->
            <text x="50%" y="86" text-anchor="middle" class="brand-text"
                  style="font:400 77px/1.05 'Momo Trust Display',-apple-system,Segoe UI,Roboto,Inter,system-ui,sans-serif; opacity:.001;">
              botcryptosignal
            </text>
          </svg>
        </div>
      </div>

      
      
        <img id="candle-img"
       alt=""
       role="presentation"
       decoding="async"
       style="display:block;width:auto;height:100%;object-fit:contain"
       src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"></svg>'>

    </div>

    <div class="divider"></div>

    <!-- –Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="bottombar">
      <div class="left">
        <span class="led" id="led" data-state="bad" title="–û–Ω–ª–∞–π–Ω (WS)"></span>
        <span class="pair" id="pair">OKX ¬∑ BTC-USDT-SWAP</span>
        <span class="time" id="time">‚Äî</span>
        <!-- –ö–Ω–æ–ø–∫–∞ –û–±–Ω–æ–≤–∏—Ç—å -->
        <button class="btn btn-icon" id="btnRefresh" title="–û–±–Ω–æ–≤–∏—Ç—å" aria-label="–û–±–Ω–æ–≤–∏—Ç—å">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <!-- SVG, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Ç–µ–º—ã: fill="currentColor", –ª–∏—à–Ω–∏–π –ø—É—Å—Ç–æ–π path —É–±—Ä–∞–Ω -->
            <path fill="currentColor"
              d="M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"/>
          </svg>
        </button>        
      </div>
    </div>
  </div>

  <!-- Settings -->
  <div class="backdrop" id="dlgSettings" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Settings">
      <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

      <div class="row">
        <div class="label">–¢–µ–º–∞</div>
        <div class="grid-3" id="themeGrid">
          <div class="pill" data-theme="light">Light</div>
          <div class="pill active" data-theme="blue">Blue</div>
          <div class="pill" data-theme="dark">Dark</div>
        </div>
      </div>

      <div class="row">
        <div class="label">–í—Ä–µ–º—è</div>
        <div class="grid-2">
          <div class="pill" data-timezone="local">–õ–æ–∫–∞–ª—å</div>
          <div class="pill active" data-timezone="utc">UTC</div>
        </div>
      </div>

      <div class="row">
        <div class="label">–§–æ—Ä–º–∞—Ç</div>
        <div class="grid-2">
          <div class="pill active" data-tfmt="clock">–¢–æ–ª—å–∫–æ –≤—Ä–µ–º—è</div>
          <div class="pill" data-tfmt="rel">–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ</div>
        </div>
      </div>

      <button class="btn close" id="btnCloseSettings">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- TF -->
  <div class="backdrop" id="dlgTF" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="TF">
      <h3>–¢–∞–π–º—Ñ—Ä–µ–π–º</h3>
      <div class="grid-3" id="tfGrid">
        <div class="pill" data-tf="15m">15m</div>
        <div class="pill  active" data-tf="1h">1h</div>
        <div class="pill"  data-tf="4h">4h</div>
        <div class="pill" data-tf="8h">8h</div>
        <div class="pill" data-tf="12h">12h</div>
        <div class="pill" data-tf="1d">1d</div>
      </div>
      <button class="btn close" id="btnCloseTF">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- Legend -->
  <div class="backdrop" id="dlgLegend" aria-hidden="true">
    <div class="modal legend" role="dialog" aria-modal="true" aria-label="Legend">
      <h3>–ß—Ç–æ –∑–Ω–∞—á–∏—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–≤–µ–∂–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö?</h3>
      <ul>
        <li><span class="dot ok"></span><b>–ó–µ–ª—ë–Ω—ã–π</b> ‚Äî –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ, –ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ –Ω–æ—Ä–º–µ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞.</li>
        <li><span class="dot warn"></span><b>–ñ—ë–ª—Ç—ã–π</b> ‚Äî –¥–∞–Ω–Ω—ã–µ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π; –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å, –Ω–æ –µ—â—ë –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö.</li>
        <li><span class="dot bad"></span><b>–ö—Ä–∞—Å–Ω—ã–π</b> ‚Äî –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏; —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É Refresh, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫.</li>
      </ul>
      <button class="btn close" id="btnCloseLegend">–ü–æ–Ω—è—Ç–Ω–æ</button>
    </div>
  </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- –í–ê–ñ–ù–û: prefs.js –¥–æ–ª–∂–µ–Ω –≥—Ä—É–∑–∏—Ç—å—Å—è –ü–ï–†–í–´–ú, –∑–∞—Ç–µ–º i18n.js -->
    <script defer src="assets/js/prefs.js?v=2"></script>
    <script defer src="assets/js/i18n.js?v=2"></script>

    <script>
      // –ë–∞–∑–∞ ‚Äî —Ç–æ—Ç –∂–µ –¥–æ–º–µ–Ω (—á–µ—Ä–µ–∑ Nginx/Cloudflare/Time4VPS)
      window.OKX_API_BASE = "/";
    </script>

    <!-- –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ API (ChartAPI) -->
    <script defer src="assets/js/chart.api.js?v=3"></script>

    <!-- UI: —Å–æ—Å—Ç–æ—è–Ω–∏–µ/–º–æ–¥–∞–ª–∫–∏/–≤—Ä–µ–º—è/—Ç–µ–º–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ª–æ–≥–∏–∫–∏) -->
    <script>
    // --- —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–¥–µ–º–æ)
    const state = {
      theme: 'blue',
      tf: '1h',
      timezone: 'utc',     // 'local' | 'utc'
      tfmt: 'clock',       // 'clock' | 'rel'
      lastUpdate: Date.now(),
      pair: 'OKX ¬∑ BTC-USDT-SWAP'
    };

    // LQDZ: —Ä–µ–∂–∏–º –∑–æ–Ω. –ë–∞–∑–æ–≤—ã–π ‚Äî SRFL (S/R Flip).
    let currentMode = 'tpcl';
    
    // –ù–∞–≤–µ—Å–∏—Ç—å –∫–ª–∏–∫ –ø–æ —Ç–∞–±–∞–º –∑–æ–Ω (SRFL|TPCL|STLC)
    const lqdzTabs = document.getElementById('lqdzTabs');
    if (lqdzTabs) {
      lqdzTabs.addEventListener('click', (e) => {
        const btn = e.target.closest('[data-mode]');
        if (!btn || !lqdzTabs.contains(btn)) return;
  
        // —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é "–≤—ã–±—Ä–∞–Ω–Ω–æ—Å—Ç—å" —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç—Ç–æ–π –≥—Ä—É–ø–ø—ã
        lqdzTabs.querySelectorAll('.btn.is-active').forEach(b => b.classList.remove('is-active'));
  
        // —Å—Ç–∞–≤–∏–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        btn.classList.add('is-active');
  
        // –º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
        currentMode = String(btn.dataset.mode || 'srfl');
        if (typeof window.loadChartPng === 'function') {
          window.loadChartPng({ reason: 'mode-change', forceFresh: true });   //  window.loadChartPng({ reason: 'mode-change' });
        }
      });
    }
      
    // --- helpers
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const pad2 = n => String(n).padStart(2,'0');

    function fmtClock(ts, tz){
      const d = new Date(ts);
      if (tz==='utc') return `${pad2(d.getUTCHours())}:${pad2(d.getUTCMinutes())}:${pad2(d.getUTCSeconds())} UTC`;
      return `${pad2(d.getHours())}:${pad2(d.getMinutes())}:${pad2(d.getSeconds())}`;
    }
    function fmtRel(ts){
      const diff = Math.max(0, Math.floor((Date.now()-ts)/1000));
      if (diff >= 3600) return 'üïê > 1h';
      const mm = Math.floor(diff/60), ss = diff%60;
      return `${pad2(mm)}:${pad2(ss)}`;
    }

    // –û–∫–Ω–æ —Å–≤–µ–∂–µ—Å—Ç–∏ –ø–æ TF (—Å–µ–∫—É–Ω–¥—ã) ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ (–±–µ–∑ –ø—Ä–∞–≤–æ–∫ –±—ç–∫–∞)
    const TF_FRESH_WINDOW_SEC = {
      "15m": 60,
      "1h": 180,
      "4h": 600,
      "8h": 900,
      "12h": 1200,
      "1d": 3600
    };

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ LED –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –¥–∞–Ω–Ω—ã—Ö (–æ—Ç state.lastUpdate)
    function updateLed(){
      const led = document.getElementById('led');
      if (!led || !window.state) return;

      const tf = String(state.tf || window.currentBar || "1h").toLowerCase();
      const P  = TF_FRESH_WINDOW_SEC[tf] || 0;
      if (!P){
        // –µ—Å–ª–∏ TF –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω, —Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç—É—Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º/–ø–ª–æ—Ö–∏–º
        led.dataset.state = "bad";
        led.title = "–°—Ç–∞—Ç—É—Å –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω";
        return;
      }

      const ageSec = Math.max(0, Math.floor((Date.now() - state.lastUpdate) / 1000));
      let st;
      if (ageSec <= P) st = "ok";
      else if (ageSec <= 3 * P) st = "warn";
      else st = "bad";

      led.dataset.state = st;
      if (st === "ok"){
        led.title = "–î–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞";
      } else if (st === "warn"){
        led.title = "–î–∞–Ω–Ω—ã–µ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π; –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–æ—Å—å";
      } else {
        led.title = "–î–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏ ‚Äî –Ω–∞–∂–º–∏—Ç–µ Refresh, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫";
      }
    }

    // –∞–≤—Ç–æ–∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞–Ω–µ–ª–∏
    function applyAutoContrast(){
      const cs = getComputedStyle(document.documentElement);
      const bg = cs.getPropertyValue('--panel').trim() || '#000';
      const rgb = bg.startsWith('#') ? hex2rgb(bg) : parseRGB(bg);
      const L = luminance(rgb);
      const text = L > 0.5 ? '#0d1321' : '#e5e7eb';
      const muted = L > 0.5 ? '#4a5568' : '#9bb0cc';
      document.documentElement.style.setProperty('--text', text);
      document.documentElement.style.setProperty('--muted', muted);
    }
    function hex2rgb(hex){
      const h = hex.replace('#','');
      const n = h.length===3 ? h.split('').map(c=>c+c).join('') : h;
      return { r:parseInt(n.slice(0,2),16), g:parseInt(n.slice(2,4),16), b:parseInt(n.slice(4,6),16) };
    }
    function parseRGB(s){ const m = s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i); return m?{r:+m[1],g:+m[2],b:+m[3]}:{r:0,g:0,b:0}; }
    function luminance({r,g,b}){ const a=[r,g,b].map(v=>{v/=255;return v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4)}); return 0.2126*a[0]+0.7152*a[1]+0.0722*a[2]; }

    // --- —Ä–µ–Ω–¥–µ—Ä
    function renderBars(){
      const pairEl = document.getElementById('pair');
      // —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–µ—Ä–µ–¥ TF –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π span, —á—Ç–æ–±—ã –µ–≥–æ —Ç–æ–∂–µ —Å–∫—Ä—ã–≤–∞—Ç—å
      pairEl.innerHTML = `${state.pair}<span class="sep-tf"> ¬∑ </span><span class="tf">${state.tf}</span>`;
      pairEl.dataset.full = pairEl.textContent.trim(); // –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Ç—É–ª—Ç–∏–ø–∞/–±—É–¥—É—â–∏—Ö —É–∂–∏–º–∞–Ω–∏–π
    }
    function renderTime(){
      $('#time').textContent = (state.tfmt==='rel') ? fmtRel(state.lastUpdate) : fmtClock(state.lastUpdate, state.timezone);
    }
    function setTheme(t){
      state.theme = t;
      document.documentElement.setAttribute('data-theme', t);
      applyAutoContrast();
    
      // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã (—Å –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π)
      if (typeof window.loadChartPng === 'function') {
        window.loadChartPng({ reason: 'theme-change', forceFresh: false });
      }
    }

    // --- –º–æ–¥–∞–ª–∫–∏
    function show(el){ el.classList.add('show'); el.setAttribute('aria-hidden','false'); }
    function hide(el){ el.classList.remove('show'); el.setAttribute('aria-hidden','true'); }

    const dlgSettings = $('#dlgSettings');
    const dlgTF = $('#dlgTF');
    const dlgLegend = $('#dlgLegend');

    // settings
    $('#btnSettings').addEventListener('click', ()=>show(dlgSettings));
    $('#btnCloseSettings').addEventListener('click', ()=>hide(dlgSettings));
    dlgSettings.addEventListener('click', (e)=>{ if(e.target===dlgSettings) hide(dlgSettings); });

    $('#themeGrid').addEventListener('click', (e)=>{
      const p = e.target.closest('.pill[data-theme]'); if(!p) return;
      $$('#themeGrid .pill').forEach(x=>x.classList.toggle('active', x===p));
      setTheme(p.dataset.theme);
    });

    $$('#dlgSettings [data-timezone]').forEach(p=>p.addEventListener('click', ()=>{
      $$('#dlgSettings [data-timezone]').forEach(x=>x.classList.remove('active'));
      p.classList.add('active'); state.timezone = p.dataset.timezone; renderTime();
    }));
    $$('#dlgSettings [data-tfmt]').forEach(p=>p.addEventListener('click', ()=>{
      $$('#dlgSettings [data-tfmt]').forEach(x=>x.classList.remove('active'));
      p.classList.add('active'); state.tfmt = p.dataset.tfmt; renderTime();
    }));

    // TF
    $('#btnTF').addEventListener('click', ()=>show(dlgTF));
    $('#btnCloseTF').addEventListener('click', ()=>hide(dlgTF));
    dlgTF.addEventListener('click', (e)=>{ if(e.target===dlgTF) hide(dlgTF); });
    $('#tfGrid').addEventListener('click', (e)=>{
      const p = e.target.closest('.pill[data-tf]'); if(!p) return;
      $$('#tfGrid .pill').forEach(x=>x.classList.toggle('active', x===p));
      state.tf = p.dataset.tf;

      // –ø–æ–¥–ø–∏—Å—å –Ω–∞ –∫–Ω–æ–ø–∫–µ ¬´TF ¬∑ <val>¬ª
      const tfBtnVal = document.getElementById('tfBtnVal');
      if (tfBtnVal) tfBtnVal.textContent = state.tf;

      // –æ–±–Ω–æ–≤–ª—è–µ–º –Ω–∏–∂–Ω—é—é —Å—Ç—Ä–æ–∫—É (¬´‚Ä¶ ¬∑ <tf>¬ª)
      renderBars();
      hide(dlgTF);
    });

    // legend by indicator click
    $('#led').addEventListener('click', ()=>show(dlgLegend));
    $('#btnCloseLegend').addEventListener('click', ()=>hide(dlgLegend));
    dlgLegend.addEventListener('click', (e)=>{ if(e.target===dlgLegend) hide(dlgLegend); });

    // —Ç–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–≤–µ–∂–µ—Å—Ç–∏
    setInterval(function(){
      renderTime();
      updateLed();
    }, 1000);

    // —Å—Ç–∞—Ä—Ç
    setTheme('blue');     // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Å–∏–Ω—è—è
    state.lastUpdate = Date.now();
    renderBars();
    renderTime();
    updateLed();
      
    // NEW: –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫–Ω–æ–ø–∫—É TF –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É state.tf (–Ω–∞ –±—É–¥—É—â–µ–µ, –µ—Å–ª–∏ –¥–µ—Ñ–æ–ª—Ç –º–µ–Ω—è–µ—Ç—Å—è –∏–∑ prefs)
    const tfBtnVal = document.getElementById('tfBtnVal');
    if (tfBtnVal) tfBtnVal.textContent = state.tf;

    // ESC –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–∞–ª–∫–∏
    document.addEventListener('keydown', e=>{
      if(e.key==='Escape'){ [dlgSettings, dlgTF, dlgLegend].forEach(hide); }
    });
  </script>

  <script>
  // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ì–†–ê–§–ò–ö–ê (—Å–≤—è–∑–∫–∞ —Å API)
  // –§–∞–π–ª/–±–ª–æ–∫: /First/chart.html
  // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
  //   ‚Ä¢ –ù–∞ —Å—Ç–∞—Ä—Ç–µ –∏ –ø—Ä–∏ —Å–º–µ–Ω–µ TF/–Ω–∞–∂–∞—Ç–∏–∏ Refresh ‚Äî –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å PNG –∏ –ø–æ–¥–º–µ–Ω—è—Ç—å <img>.
  //   ‚Ä¢ –ë–µ–∑ –¥—É–±–ª–µ–π –∏ ¬´–æ—Ç–æ—Ä–≤–∞–Ω–Ω—ã—Ö¬ª –∫—É—Å–∫–æ–≤.
  (function () {
    // --- –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL ---
    const qp = new URLSearchParams(location.search);
    const DEFAULT_INST = (qp.get("symbol") || "BTC-USDT-SWAP").trim();
    // –•—Ä–∞–Ω–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π TF –≥–ª–æ–±–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –ø–ª–æ–¥–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥—É–±–ª–∏
    window.currentBar = String(qp.get("bar") || (typeof state === "object" ? state.tf : "1h") || "1h").toLowerCase();
  
    // --- —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ---
    const img        = document.getElementById("candle-img");
    const pairEl     = document.getElementById("pair");
    const tfGrid     = document.getElementById("tfGrid");
    const tfBtnVal   = document.getElementById("tfBtnVal");
    const btnRefresh = document.getElementById("btnRefresh") || document.getElementById("btn-refresh");

    // --- –ö—Ä—É—Ç–∏–ª–∫–∞ —Å–º–µ—Ç—ã TF, –¢–µ–º—ã –∏ SRFL/TPCL/STLC ---
    const spinner = document.getElementById('chartSpinner');
    let _spinTimer = null;
    
    function spinShow(){
      if (!spinner) return;
      spinner.classList.remove('ok','error');
      spinner.classList.add('show');
    }
    function spinSuccess(){
      if (!spinner) return;
      spinner.classList.add('ok');
      clearTimeout(_spinTimer);
      _spinTimer = setTimeout(()=>{ spinner.classList.remove('ok','show'); }, 150);
    }
    function spinError(){
      if (!spinner) return;
      spinner.classList.add('error');
      clearTimeout(_spinTimer);
      _spinTimer = setTimeout(()=>{ spinner.classList.remove('error','show'); }, 150);
    }
    function spinHide(){
      if (!spinner) return;
      spinner.classList.remove('ok','error','show');
    }

  
    // --- —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ –≤–Ω–∏–∑—É ---
    if (typeof state === "object") {
      state.pair = `OKX ¬∑ ${DEFAULT_INST}`;
      state.tf   = window.currentBar;
      try { renderBars(); } catch { /* no-op */ }
      if (tfBtnVal) tfBtnVal.textContent = state.tf;
    }
  
    // --- —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ–¥ –∫–µ—à ---
    function resolveCanvas() {
      const root = document.getElementById("chartRoot");
      const r = (root && root.getBoundingClientRect) ? root.getBoundingClientRect() : { width: 0, height: 0 };
  
      // –í—ã—Å–æ—Ç–∞ = 100% –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞; —à–∏—Ä–∏–Ω–∞ ‚Äî –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–º—É —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é –æ–±–ª–∞—Å—Ç–∏
      const ch0   = Math.max(240, Math.round(r.height || 0));
      const ratio = (r.width > 0 && r.height > 0) ? (r.width / r.height) : 1.5;
      const cw0   = Math.max(360, Math.round(ch0 * ratio));
  
      const round = 64; // –∫—Ä–∞—Ç–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö URL –≤ –∫–µ—à–∞—Ö
      const ch = Math.max(240, Math.floor(ch0 / round) * round);
      const cw = Math.max(360, Math.floor(cw0 / round) * round);
  
      return { cw, ch, round };
    }
  
    // --- –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ PNG (async/await –¢–û–õ–¨–ö–û —Ç—É—Ç) ---
    // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ì–†–ê–§–ò–ö–ê (—Å–≤—è–∑–∫–∞ —Å API)
    // –§–∞–π–ª/–±–ª–æ–∫: /First/chart.html
    //   ‚Ä¢ –ù–∞ —Å—Ç–∞—Ä—Ç–µ –∏ –ø—Ä–∏ —Å–º–µ–Ω–µ TF/–Ω–∞–∂–∞—Ç–∏–∏ Refresh ‚Äî –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å PNG –∏ –ø–æ–¥–º–µ–Ω—è—Ç—å <img>.
    async function loadPng(forceFresh = false, showSpin = false) {
      const img = document.getElementById("candle-img");
      if (!img) return;
      if (showSpin) spinShow();
    
      try {
        // --- —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ —Ä–∞–∑–º–µ—Ä—ã
        const root = document.getElementById("chartRoot");
        const r = (root && root.getBoundingClientRect) ? root.getBoundingClientRect() : { width: 0, height: 0 };
        
        // –≤—ã—Å–æ—Ç–∞ = 100% –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        const ch0 = Math.max(240, Math.round(r.height || 0));
        
        // --- –≥–µ–æ–º–µ—Ç—Ä–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ ------------------------------------------------
        // –ú–∏–Ω–∏–º—É–º 2:3 (H:W) ‚Üí W/H >= 1.5
        const MIN_AR = 1.5;
        const liveAR = (r.width > 0 && r.height > 0) ? (r.width / r.height) : MIN_AR;
        const ratio  = Math.max(liveAR, MIN_AR);

        // –±–∞–∑–æ–≤–∞—è –≤—ã—Å–æ—Ç–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        // const ch0 = Math.max(240, Math.round(r.height || 0));

        // –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –ø–æ–¥ –∫–µ—à (–∫—Ä–∞—Ç–Ω–æ 64) + –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –Ω–µ –Ω–∏–∂–µ 512 –ø–æ –≤—ã—Å–æ—Ç–µ
        const ROUND = 64;
        const ch_base = Math.max(512, Math.floor(ch0 / ROUND) * ROUND);     // –±—ã–ª–æ: >=240 ‚Üí —Å—Ç–∞–ª–æ: >=512
        const cw_base = Math.max(360, Math.floor((ch_base * ratio) / ROUND) * ROUND);

        // –ª—ë–≥–∫–∏–π –∞–ø—Å–∫–µ–π–ª —Ä–µ–Ω–¥–µ—Ä–∞ (–¥–µ–ª–∞–µ–º PNG —á—É—Ç—å –∫—Ä—É–ø–Ω–µ–µ –¥–ª—è —Ä–µ–∑–∫–æ—Å—Ç–∏ –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏)
        // 1.2 ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏/–≤–µ—Å—É, –≤—ã—à–µ 1.33 –æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ
        const UPSCALE = 1.2;
        const cw_req = Math.min(
          2048,
          Math.max(360, Math.floor((cw_base * UPSCALE) / ROUND) * ROUND)
        );
        const ch_req = Math.min(
          1536,
          Math.max(512, Math.floor((ch_base * UPSCALE) / ROUND) * ROUND)
        );

        // –º—è–≥–∫–∏–π –º–∞—Å—à—Ç–∞–± —à—Ä–∏—Ñ—Ç–æ–≤ (—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞) ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ
        let font_Scale = 1.0;
        if (ch_base < 420) font_Scale = 1.29;
        else if (ch_base > 720) font_Scale = 1.1;
        
        // DPR (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–µ –º–Ω–æ–∂–∏–º –µ–≥–æ –Ω–∞ UPSCALE ‚Äî –º–∞—Å—à—Ç–∞–± —É–∂–µ —É—á—Ç—ë–Ω –≤ cw_req/ch_req)
        const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
    
        // –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç/TF
        const qs   = new URLSearchParams(location.search);
        const inst = (window.encInst || qs.get("symbol") || qs.get("inst") || "BTC-USDT-SWAP").trim();
        const bar  = (typeof window.currentBar === "string" && window.currentBar)
                      ? window.currentBar.toLowerCase()
                      : (qs.get("bar") || "1h").toLowerCase();
    
        // –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–µ CSS –Ω–∞ <img>
        img.style.display   = "block";
        img.style.width     = "auto";
        img.style.height    = "100%";
        img.style.objectFit = "contain";

        /* BRAND_PLACEHOLDER (–ø–æ –¢–ó): –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ä–∞–∑—É + —Ñ–µ–π–ª-—Å–µ–π—Ñ 15s */
        const brand = document.getElementById('brandHolder');
        let brandFailT = null;
        if (brand) {
          brand.style.display = 'flex';
          brandFailT = setTimeout(() => { try { brand.remove(); } catch (_) {} }, 15000);
        }
        
        // --- –∑–∞–ø—Ä–æ—Å JSON-–ø—Ä–æ–∫–ª–∞–¥–∫–∏ ‚Üí –æ—Ç–¥–∞—ë—Ç –≥–æ—Ç–æ–≤—ã–π URL PNG
        const currentTheme =
          document.documentElement.getAttribute('data-theme') || 'blue';
        
        const params = new URLSearchParams({
          inst, bar,
          cw: String(cw_req), ch: String(ch_req),
          dpr: String(dpr), round: String(ROUND),
          fresh: forceFresh ? "1" : "0",
          font_scale: String(font_Scale),
          mode: currentMode,               // ‚Üê LQDZ —Ä–µ–∂–∏–º –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –±–µ–∫

          // --- –ù–æ–≤—ã–µ —Ñ–ª–∞–≥–∏ —Ä–µ–Ω–¥–µ—Ä–∞ (–Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ –±—ç–∫–µ) ---
          yfmt: "si",   // –±–µ–∑ SI-—Å—É—Ñ—Ñ–∏–∫—Å–æ–≤ (k, m, Œº, n) –ø–æ–º–µ–Ω—è—Ç—å ¬´SI-—Å—É—Ñ—Ñ–∏–∫—Å—ã¬ª yfmt –Ω–∞ "si"
          //  prec: "6",       // 6 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π (–ø–æ–¥–ø—Ä–∞–≤–∏—à—å –ø–æ–¥ –º–æ–Ω–µ—Ç—É)
          pad_ticks: "0",           // 0 ‚Äî –±–∞–∑–æ–≤—ã–π; +1 —Ä–∞—Å—à–∏—Ä—è–µ—Ç; -1 —Å—É–∂–∞–µ—Ç
          theme: currentTheme,
          mode: currentMode,  // LQDZ: –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ–º —Ä–µ–∂–∏–º –∑–æ–Ω srfl|tpcl|stlc
        });
    
        const jsonUrl = "/render/candle?" + params.toString();
        const r1 = await fetch(jsonUrl, { cache: "no-store" });
        if (!r1.ok) throw new Error("render/candle JSON http " + r1.status);
    
        const j = await r1.json();
        if (!j || !j.url) throw new Error("render/candle bad JSON");
    
        // –ø—Ä–æ–¥: —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏
        console.log("[chart] loading", j.url);
    
        // –ü–æ–¥–º–µ–Ω–∞ PNG + –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–µ–∑ –æ–≤–µ—Ä–ª–µ—è
        img.onerror = function () {
          spinError();
          var d = document.getElementById("chartDebug");
          if (d) d.textContent = "PNG load error ‚Üí " + j.url;
          /* –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π ‚Äî –ø—Ä–∏ –æ—à–∏–±–∫–µ —Ç–æ–∂–µ —Å—Ç–∞–≤–∏–º —Å—Ç–∞—Ä—Ç –≤ –Ω–∞—á–∞–ª–æ */
          const root = document.getElementById("chartRoot");
          if (root) root.scrollLeft = 0;
        };
        img.onload = function () {
          spinSuccess();

          // –§–∏–∫—Å–∏—Ä—É–µ–º –º–æ–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
          try {
            state.lastUpdate = Date.now();
            renderTime();
            updateLed();
          } catch (_) {}

          /* –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–º–µ–Ω—ã PNG ‚Äî –Ω–∞—á–∞—Ç—å —Å –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è */
          const root = document.getElementById("chartRoot");
          if (root) root.scrollLeft = 0;
        
          var d = document.getElementById("chartDebug");
          if (d) d.textContent = "";
          /* BRAND_PLACEHOLDER: –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî —É–±—Ä–∞—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä, —á—Ç–æ–±—ã –Ω–µ –∫—Ä—É—Ç–∏—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ */
          try {
            const brand = document.getElementById('brandHolder');
            if (brand) brand.remove();
            if (brandFailT) { clearTimeout(brandFailT); brandFailT = null; }
          } catch (_) {}
        };
        img.src = j.url;
    
      } catch (e) {
        spinError();
        // –ø—Ä–æ–¥: —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏
        console.error("[chart] loadPng error:", e);
      }
        // –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: —É–ø—Ä–∞–≤–ª—è–µ–º –∏ fresh, –∏ —Å–ø–∏–Ω–Ω–µ—Ä–æ–º
        window.loadChartPng = (opts = {}) => {
        const reason = opts.reason || null;
        const force  = !!opts.forceFresh;

        // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–∫–ª—é—á–∞–µ–º –¢–û–õ–¨–ö–û –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã, TF, —Ä–µ–∂–∏–º–∞ –∑–æ–Ω, –∏ –ø—Ä–∏ —Ä—É—á–Ω–æ–º Refresh
        const showSpin =
          reason === 'theme-change' ||
          reason === 'tf-change'    ||
          reason === 'mode-change'  ||
          reason === 'manual-refresh';
      
        return loadPng(force, showSpin);
      };
    }
  
    // --- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã TF ---
    tfGrid?.addEventListener("click", (e) => {
      const pill = e.target.closest(".pill[data-tf]");
      if (!pill) return;
      window.currentBar = String(pill.dataset.tf || "1h").toLowerCase();
      if (tfBtnVal) tfBtnVal.textContent = window.currentBar;
      if (typeof state === "object") {
        state.tf = window.currentBar;
        try { renderBars(); } catch {}
      }
      window.loadChartPng({ reason: 'tf-change', forceFresh: true });
    });
  
    // --- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ Refresh ---
    btnRefresh?.addEventListener("click", () => {
      // –∑–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç–æ—á–∫—É, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏–ª—Å—è —Å–ø–∏–Ω–Ω–µ—Ä
      if (typeof window.loadChartPng === 'function') {
        window.loadChartPng({ reason: 'manual-refresh', forceFresh: true });
      } else {
        // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –Ω–∞ —Ä–∞–Ω–Ω–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        try { loadPng(true, /*showSpin*/ true); } catch {}
      }
    });
  
    // --- –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ + –∞–≤—Ç–æ-—Ä–µ—Å–∞–π–∑ ---
    window.addEventListener("DOMContentLoaded", () => {
      // —Å—Ä–∞–∑—É –ø—Ä–∏–∂–∏–º–∞–µ–º —Å–∫—Ä–æ–ª–ª –∫ –Ω–∞—á–∞–ª—É
      const root = document.getElementById("chartRoot");
      if (root) root.scrollLeft = 0;
    
      // –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å PNG ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
      let firstRun = true;
      let t;
    
      if ("ResizeObserver" in window && root) {
        const ro = new ResizeObserver(() => {
          clearTimeout(t);
          t = setTimeout(() => {
            loadPng(false);
            firstRun = false;
          }, 220); // debounce
        });
        ro.observe(root);
    
        // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞: –µ—Å–ª–∏ RO –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (—ç–∫–∑–æ—Ç–∏–∫–∞), —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É —Å–¥–µ–ª–∞–µ–º –æ–¥–∏–Ω —Å—Ç–∞—Ä—Ç
        setTimeout(() => { if (firstRun) loadPng(false); }, 300);
      } else {
        // –±–µ–∑ RO –¥–∞—ë–º –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –µ–¥–∏–Ω–∏—á–Ω—ã–π —Å—Ç–∞—Ä—Ç
        setTimeout(() => loadPng(false), 220);
        window.addEventListener("resize", () => {
          clearTimeout(window.__chart_resize_t);
          window.__chart_resize_t = setTimeout(() => loadPng(false), 220);
        });
      }
    });
  })();
  </script>

  <!-- –í–†–ï–ú–ï–ù–ù–´–ô –û–¢–õ–ê–î–û–ß–ù–´–ô –ë–õ–û–ö: —Ç–µ–ø–µ—Ä—å –ë–ï–ó size=P-M -->
  <script>
  // --- –í–†–ï–ú–ï–ù–ù–´–ô –û–¢–õ–ê–î–û–ß–ù–´–ô –ë–õ–û–ö: –≤—ã–≤–æ–¥ JSON –≤–º–µ—Å—Ç–æ –≥—Ä–∞—Ñ–∏–∫–∞ -----------------
  // –§–∞–π–ª/–±–ª–æ–∫: /First/chart.html (debug-json)
  // –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
  //   ‚Ä¢ –ù–∞ —Å—Ç–∞—Ä—Ç–µ, –ø—Ä–∏ —Å–º–µ–Ω–µ TF –∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Refresh ‚Äî –¥–µ–ª–∞–µ—Ç fetch JSON
  //     –Ω–∞ /render/candle (–ª—ë–≥–∫–∏–π JSON-—ç–Ω–¥–ø–æ–∏–Ω—Ç) –∏ –ø–µ—á–∞—Ç–∞–µ—Ç –≤ <pre id="json-view">.
  (function(){
    // –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ?symbol=... –∏ ?bar=...
    const qp   = new URLSearchParams(location.search);
    const inst = (qp.get("symbol") || "BTC-USDT-SWAP").trim();
    let   bar  = String(qp.get("bar") || "1h").toLowerCase();

    const out  = document.getElementById("json-view");

    function show(obj){
      if (!out) return;
      out.textContent = JSON.stringify(obj, null, 2);
    }

    async function load(){
      try{
        // /render/candle —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ cw/ch/dpr/round/font_scale
        const root = document.getElementById("chartRoot");
        const r = root?.getBoundingClientRect() || { width: 0, height: 0 };
        const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
        const round = 64;
        const p = new URLSearchParams({
          inst, bar,
          cw: Math.round(r.width),
          ch: Math.round(r.height),
          dpr: dpr.toString(),
          round: round.toString(),
          fresh: "0",
          font_scale: "2"
        });
        const url = window.OKX_API_BASE + "render/candle?" + p.toString();
        const res = await fetch(url, { cache: "no-store" });
        const data = await res.json().catch(()=> ({}));
        show({ endpoint: "/render/candle", status: res.status, ok: res.ok, data });
      }catch(e){
        show({ endpoint: "/render/candle", error: String(e) });
      }
    }

    // –•—É–∫–∏ –Ω–∞ TF –∏ Refresh ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º JSON
    document.getElementById("tfGrid")?.addEventListener("click", (e)=>{
      const p = e.target.closest(".pill[data-tf]");
      if (!p) return;
      bar = String(p.dataset.tf || "1h").toLowerCase();
      load();
    });

    document.getElementById("btnRefresh")?.addEventListener("click", () => loadPng());

    // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    // window.addEventListener("DOMContentLoaded", () => loadPng(false));

  })();
  </script>
  <script>
  (function(){
    const wrap = document.getElementById('chartRoot');
    if (!wrap) return;
  
    let isDown = false, startX = 0, scrollLeft = 0;
  
    const onDown = (clientX) => {
      isDown = true;
      startX = clientX - wrap.offsetLeft;
      scrollLeft = wrap.scrollLeft;
      wrap.classList.add('dragging');
    };
    const onMove = (clientX) => {
      if (!isDown) return;
      const x = clientX - wrap.offsetLeft;
      wrap.scrollLeft = scrollLeft - (x - startX);
    };
    const onUp = () => { isDown = false; wrap.classList.remove('dragging'); };
  
    // –ú—ã—à—å
    wrap.addEventListener('mousedown', e => onDown(e.clientX));
    wrap.addEventListener('mousemove', e => onMove(e.clientX));
    wrap.addEventListener('mouseleave', onUp);
    wrap.addEventListener('mouseup', onUp);
  
    // –¢–∞—á
    wrap.addEventListener('touchstart', e => onDown(e.touches[0].clientX), {passive:true});
    wrap.addEventListener('touchmove',  e => onMove(e.touches[0].clientX), {passive:true});
    wrap.addEventListener('touchend', onUp);
  })();
  </script>

</body>
</html>
