<!doctype html>
<html lang="ru">
<head>
  <!--
    CHANGES:
      ‚Ä¢ mobile-first: meta viewport + safe-area
      ‚Ä¢ –∫–Ω–æ–ø–∫–∞ —Å–≤–µ—Ä–Ω—É—Ç—å –≤—ã–Ω–µ—Å–µ–Ω–∞ –°–õ–ï–í–ê –æ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–∞–Ω–µ–ª–∏
      ‚Ä¢ –≤ –¥–æ–∫-–±–∞—Ä–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "üìä –ü–æ–ª–∫–∏" (volume shelves)
      ‚Ä¢ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ CSS/JS —Ñ–∞–π–ª—ã (–Ω–∏–∫–∞–∫–æ–≥–æ inline-—Å—Ç–∏–ª—è)
  -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>OKX SWAP Chart</title>

  <!-- CSP: —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' https://telegram.org https://s3.tradingview.com https://*.tradingview.com https://unpkg.com;
                 img-src 'self' data: https:;
                 style-src 'self';
                 script-src 'self' https://telegram.org https://s3.tradingview.com https://unpkg.com;
                 connect-src 'self' https://www.okx.com wss://ws.okx.com wss://wsaws.okx.com;">

  <!-- CSS -->
  <link rel="stylesheet" href="assets/css/chart.css" />

  <!-- –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

  <!-- –Ω–∞—à –∫–æ–¥ -->
  <script defer src="assets/js/okx_chart.js"></script>
  <script defer src="assets/js/ui_panel.js"></script>
</head>
<body>
<div id="wrap">
  <header id="title">BTC ‚Ä¢ USDT-SWAP (OKX)</header>

  <!-- NOTE: –æ—Ç–¥–µ–ª—å–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ –ø–æ–¥ —Ö–æ–ª—Å—Ç —Å ‚Äú–ø–æ–ª–∫–∞–º–∏ –ø–æ –æ–±—ä—ë–º—É‚Äù -->
  <div id="chart-wrap">
    <div id="chart"></div>
    <canvas id="shelves" width="0" height="0" aria-hidden="true"></canvas>
  </div>

  <!-- –î–æ–∫-–±–∞—Ä (–≤–Ω–∏–∑—É) -->
  <footer id="dock" aria-label="status bar">
    <div id="status-dot" class="offline" aria-hidden="true" title="–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è"></div>
    <span id="status-text" title="–ù–∞–∂–º–∏—Ç–µ i –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏">–û—Ñ—Ñ–ª–∞–π–Ω</span>
    <button id="btn-status-info" class="muted" type="button" aria-haspopup="dialog" aria-expanded="false" title="–ß—Ç–æ –∑–Ω–∞—á–∏—Ç —ç—Ç–æ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?">i</button>
    <div class="spacer"></div>
    <!-- NOTE: –Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ ‚Äú–ü–æ–ª–∫–∏‚Äù -->
    <button id="btn-vol" type="button" title="–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–∫–∏ –ø–æ –æ–±—ä—ë–º—É">üìä –ü–æ–ª–∫–∏</button>
    <button id="btn-panel" aria-expanded="false" aria-controls="panel" title="–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">‚ñ≤</button>
  </footer>

  <!-- –ü–æ–ø–æ–≤–µ—Ä —Å–æ —Å–ø—Ä–∞–≤–∫–æ–π –æ —Å—Ç–∞—Ç—É—Å–µ -->
  <section id="status-popover" role="dialog" aria-modal="false" hidden>
    <div class="tip-card">
      <div class="tip-title">–ß—Ç–æ –∑–Ω–∞—á–∏—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è?</div>
      <ul class="tip-list">
        <li>üü¢ <b>–û–Ω–ª–∞–π–Ω (WS)</b> ‚Äî –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</li>
        <li>üü° <b>–î–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞–Ω (REST)</b> ‚Äî WebSocket –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è.</li>
        <li>üî¥ <b>–û—Ñ—Ñ–ª–∞–π–Ω</b> ‚Äî –Ω–µ—Ç —Å–≤—è–∑–∏ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏.</li>
      </ul>
      <button id="btn-tip-close" type="button" class="muted" title="–ó–∞–∫—Ä—ã—Ç—å">–ü–æ–Ω—è—Ç–Ω–æ</button>
    </div>
  </section>

  <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
  <section id="panel" role="dialog" aria-modal="true" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞" hidden>
    <div id="panel-head">
      <!-- NOTE: ‚Äú–°–≤–µ—Ä–Ω—É—Ç—å‚Äù —Å–ª–µ–≤–∞ -->
      <button id="btn-close" type="button" title="–°–≤–µ—Ä–Ω—É—Ç—å">–°–≤–µ—Ä–Ω—É—Ç—å</button>
      <div id="panel-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
    </div>

    <div id="panel-body">
      <!-- —Å—Ç—Ä–æ–∫–∞ 1: –¢–§ -->
      <div class="row" id="row-intervals">
        <span class="muted">–¢–∞–π–º—Ñ—Ä–µ–π–º:</span>
        <!-- NOTE: –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä TF; data-int = –º–∏–Ω—É—Ç—ã -->
        <a data-int="15"   class="int">15m</a>
        <a data-int="60"   class="int">1h</a>
        <a data-int="240"  class="int">4h</a>
        <a data-int="480"  class="int">8h</a>
        <a data-int="720"  class="int">12h</a>
        <a data-int="1440" class="int">1d</a>
        <span id="last-upd" title="–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ">‚Ä¶</span>
      </div>

      <!-- —Å—Ç—Ä–æ–∫–∞ 2: –ò—Å—Ç–æ—á–Ω–∏–∫ -->
      <div class="row" id="row-sources">
        <span class="muted">–ò—Å—Ç–æ—á–Ω–∏–∫:</span>
        <button type="button" class="src" data-src="okx">OKX (API/WS)</button>
        <button type="button" class="src" data-src="tv">TradingView (–≤–∏–¥–∂–µ—Ç)</button>
        <span id="sym" class="muted" style="margin-left:auto"></span>
      </div>

      <!-- —Å—Ç—Ä–æ–∫–∞ 3: –î–µ–π—Å—Ç–≤–∏—è -->
      <div class="row" id="row-actions">
        <button id="btn-fav"  class="star"  type="button" aria-pressed="false">‚≠êÔ∏è –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
        <a id="okx-link" class="danger" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –Ω–∞ OKX</a>
        <a id="tv-link"  class="muted"  target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –≤ TradingView</a>
        <button id="btn-copy" class="muted" type="button">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
        <!-- –¥—É–±–ª—å ‚Äú–ü–æ–ª–∫–∏‚Äù –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–µ–ª–∏ -->
        <button id="btn-vol2" class="ghost" type="button" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–ª–∫–∏">üìä –ü–æ–ª–∫–∏</button>
      </div>
    </div>
  </section>

  <div class="hint" id="hint"></div>
</div>

<!-- –Ω–µ–±–æ–ª—å—à–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—å WebApp –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É -->
<script>try{window.Telegram?.WebApp?.expand?.()}catch(e){}</script>
</body>
</html>
